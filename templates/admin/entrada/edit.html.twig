{% extends "admin/bars.html.twig" %}
{% block title %}Edición Entrada {{ entrada.id }} {% endblock %}

{% block stylesheets %}
    {{ parent() }}
{#    {{ encore_entry_link_tags('select2-parent') }}#}
    {{ encore_entry_link_tags('select2') }}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.7.1/min/dropzone.min.css"
          integrity="sha256-AgL8yEmNfLtCpH+gYp9xqJwiDITGqcwAbI8tCfnY2lw=" crossorigin="anonymous"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.10.2/Sortable.min.js"
            integrity="sha512-ELgdXEUQM5x+vB2mycmnSCsiDZWQYXKwlzh9+p+Hff4f5LA+uf0w2pOp3j7UAuSAajxfEzmYZNOOLQuiotrt9Q=="
            crossorigin="anonymous"></script>
    {{ encore_entry_link_tags('ckeditor_config') }}
    <link rel="stylesheet" href="{{ asset('bundles/tinymce/ext/tinymce/skins/content/default/content.css') }}"
          integrity="sha256-AgL8yEmNfLtCpH+gYp9xqJwiDITGqcwAbI8tCfnY2lw=" crossorigin="anonymous"/>


{% endblock %}

{% block contenpage %}
    <div class="container">
        {% for message in app.flashes('error') %}
            <div class="alert alert-danger">
                {{ message }}
            </div>
        {% endfor %}
    </div>
    <div class="container">
        <h4>Edición de {{ entrada.titulo | striptags | raw }} desde {{ ip }}</h4>
        <hr>
        <div class="row">
            <div class="col-sm-12 mx-auto">
                <h3>Detalles</h3>
                {{ include('admin/entrada/_form.html.twig', {'button_label': 'Actualizar'}) }}
                <a href="{{ path('admin_entrada_index') }}" class="btn btn-sm btn-info">Volver al Listado</a>
                {{ include('admin/entrada/_delete_form.html.twig') }}
            </div>
            <div class="col-sm-12">
                <h3>Referencias</h3>
                <ul style="font-size: 0.7rem"
                    class="list-group small js-reference-list"
                    data-url="{{ path('admin_entrada_list_referencia', {id: entrada.id}) }}">
                </ul>

                <form action="{{ path('admin_entrada_add_referencia',{
                    id: entrada.id
                }) }}" method="POST" enctype="multipart/form-data" class="dropzone js-reference-dropzone">

                </form>
                {% if entrada.sections %}
                    <tr>
                        <td colspan="10">
                            <div class="col-sm-12">
                                <h3>Secciones</h3>
                                <div style="font-size: 0.9rem"
                                     class="list-group small js-section-list col-sm-12"
                                     data-entrada= {{ entrada.id }}
                                     data-url="{{ path('admin_entrada_list_section', {id: entrada.id}) }}">
                                </div>

                            </div>
                        </td>
                    </tr>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="mb-5"></div>

{% endblock %}
{% block javascripts %}
    {{ parent() }}
    {{ encore_entry_script_tags('select2') }}

    <script src="{{ asset('js/admin_section_entrada_form.js') }}"></script>
    <script src="{{ asset('bundles/tinymce/ext/tinymce/tinymce.min.js') }}"></script>
    <script src="{{ asset('bundles/tinymce/ext/tinymce-webcomponent.js') }}"></script>
{#    <script src="{{ asset('bundles/tinymce/ext/tinymce/plugins/help/js/i18n/keynav/es.js') }}"></script>#}
    <script src="{{ asset('bundles/tinymce/ext/tinymce/skins/content/default/content.js') }}"></script>



    <script>
        // tinymce.init({
        //     selector: 'textarea#entrada_title',
        //     language: "es",
        //     height: 300,
        //     plugins: [
        //         'advlist autolink lists link image charmap print preview hr anchor pagebreak',
        //         'searchreplace wordcount visualblocks visualchars code fullscreen',
        //         'insertdatetime media nonbreaking save table contextmenu directionality',
        //         'emoticons template paste textcolor colorpicker textpattern imagetools codesample toc'
        //     ],
        // })
        tinymce.init({
            selector: '#entrada_titulo',
            language: 'es',
            plugins: 'preview importcss searchreplace autolink autosave save directionality code visualblocks visualchars fullscreen image link media codesample table charmap pagebreak nonbreaking anchor insertdatetime advlist lists wordcount help charmap quickbars emoticons accordion',
            editimage_cors_hosts: ['picsum.photos'],
            // menubar: 'file edit view insert format tools table help',
            // toolbar: "undo redo | accordion accordionremove | blocks fontfamily fontsize | bold italic underline strikethrough | align numlist bullist | link image | table media | lineheight outdent indent| forecolor backcolor removeformat | charmap emoticons | code fullscreen preview | save print | pagebreak anchor codesample | ltr rtl",
            // autosave_ask_before_unload: true,
            // autosave_interval: '30s',
            // autosave_prefix: '{path}{query}-{id}-',
            // autosave_restore_when_empty: false,
            // autosave_retention: '2m',
            // image_advtab: true,
            // link_list: [
            //     { title: 'My page 1', value: 'https://www.tiny.cloud' },
            //     { title: 'My page 2', value: 'http://www.moxiecode.com' }
            // ],
            // image_list: [
            //     { title: 'My page 1', value: 'https://www.tiny.cloud' },
            //     { title: 'My page 2', value: 'http://www.moxiecode.com' }
            // ],
            // image_class_list: [
            //     { title: 'None', value: '' },
            //     { title: 'Some class', value: 'class-name' }
            // ],
            // importcss_append: true,
            // file_picker_callback: (callback, value, meta) => {
            //     /* Provide file and text for the link dialog */
            //     if (meta.filetype === 'file') {
            //         callback('https://www.google.com/logos/google.jpg', { text: 'My text' });
            //     }
            //
            //     /* Provide image and alt text for the image dialog */
            //     if (meta.filetype === 'image') {
            //         callback('https://www.google.com/logos/google.jpg', { alt: 'My alt text' });
            //     }
            //
            //     /* Provide alternative source and posted for the media dialog */
            //     if (meta.filetype === 'media') {
            //         callback('movie.mp4', { source2: 'alt.ogg', poster: 'https://www.google.com/logos/google.jpg' });
            //     }
            // },
            // height: 600,
            // image_caption: true,
            // quickbars_selection_toolbar: 'bold italic | quicklink h2 h3 blockquote quickimage quicktable',
            // noneditable_class: 'mceNonEditable',
            // toolbar_mode: 'sliding',
            // contextmenu: 'link image table',
            // skin: useDarkMode ? 'oxide-dark' : 'oxide',
            // content_css: useDarkMode ? 'dark' : 'default',
            // content_style: 'body { font-family:Helvetica,Arial,sans-serif; font-size:16px }'
        });


        $('.custom-file-input').on('change', function (event) {
            const inputFile = event.currentTarget;
            $(inputFile).parent()
                .find('.custom-file-label')
                .html(inputFile.files[0].name);
        });

    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.7.1/min/dropzone.min.js"
            integrity="sha256-v7sFPKIh3GHvV9MMFBXcSBLG/BDUC7h1fpfDC5tp1FM=" crossorigin="anonymous"></script>
    <script src="{{ asset('js/admin_entrada_form.js') }}"></script>
    {{ encore_entry_script_tags('app') }}
    {{ encore_entry_script_tags('ckeditor_config') }}

{% endblock %}
{% block jslocal %}
{#    {{ encore_entry_script_tags('summernote') }}#}
{#    {{ encore_entry_script_tags('select2-parent') }}#}
{#    {{ encore_entry_script_tags('select2') }}#}
{% endblock %}
